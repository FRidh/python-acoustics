
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>acoustics._signal &#8212; acoustics 0.2.0.post1 documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">acoustics 0.2.0.post1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for acoustics._signal</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="k">import</span> <span class="n">wavfile</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="k">import</span> <span class="n">detrend</span><span class="p">,</span> <span class="n">lfilter</span><span class="p">,</span> <span class="n">bilinear</span><span class="p">,</span> <span class="n">spectrogram</span><span class="p">,</span> <span class="n">filtfilt</span><span class="p">,</span> <span class="n">resample</span><span class="p">,</span> <span class="n">fftconvolve</span>
<span class="kn">import</span> <span class="nn">acoustics</span>

<span class="kn">from</span> <span class="nn">acoustics.standards.iso_tr_25417_2007</span> <span class="k">import</span> <span class="n">REFERENCE_PRESSURE</span>
<span class="kn">from</span> <span class="nn">acoustics.standards.iec_61672_1_2013</span> <span class="k">import</span> <span class="n">WEIGHTING_SYSTEMS</span>
<span class="kn">from</span> <span class="nn">acoustics.standards.iec_61672_1_2013</span> <span class="k">import</span> <span class="p">(</span><span class="n">NOMINAL_OCTAVE_CENTER_FREQUENCIES</span><span class="p">,</span>
                                                  <span class="n">NOMINAL_THIRD_OCTAVE_CENTER_FREQUENCIES</span><span class="p">)</span>


<div class="viewcode-block" id="Signal"><a class="viewcode-back" href="../../reference.html#acoustics.Signal">[docs]</a><span class="k">class</span> <span class="nc">Signal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A signal consisting of samples (array) and a sample frequency (float).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">__array_prepare__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;fs&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s1">&#39;fs&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">fs</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">fs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">array</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sample frequencies do not match.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">array</span>

    <span class="k">def</span> <span class="nf">__array_wrap__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_arr</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">__array_wrap__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_arr</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="c1"># see InfoArray.__array_finalize__ for comments</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;fs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Get the parent&#39;s __reduce__ tuple</span>
        <span class="n">pickled_state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Signal</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()</span>
        <span class="c1"># Create our own tuple to pass to __setstate__</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">pickled_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="p">)</span>
        <span class="c1"># Return a tuple that replaces the parent&#39;s __setstate__ tuple with our own</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pickled_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pickled_state</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Set the info attribute</span>
        <span class="c1"># Call the parent&#39;s __setstate__ with the other tuple elements.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Signal</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Signal(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct signal like x.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Signal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">samples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amount of samples in signal.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amount of channels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Duration of signal in seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the values of this signal as an instance of :class:`np.ndarray`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Signal.calibrate_to"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.calibrate_to">[docs]</a>    <span class="k">def</span> <span class="nf">calibrate_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decibel</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calibrate signal to value `decibel`.</span>

<span class="sd">        :param decibel: Value to calibrate to.</span>
<span class="sd">        :param inplace: Whether to perform inplace or not.</span>
<span class="sd">        :returns: Calibrated signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        Values of `decibel` are broadcasted. To set a value per channel, use `decibel[...,None]`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">decibel</span> <span class="o">=</span> <span class="n">decibel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">gain</span> <span class="o">=</span> <span class="n">decibel</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">leq</span><span class="p">()[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.calibrate_with"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.calibrate_with">[docs]</a>    <span class="k">def</span> <span class="nf">calibrate_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">decibel</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calibrate signal with other signal.</span>

<span class="sd">        :param other: Other signal/array.</span>
<span class="sd">        :param decibel: Signal level of `other`.</span>
<span class="sd">        :param inplace: Whether to perform inplace or not.</span>
<span class="sd">        :returns: calibrated signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Signal</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
        <span class="n">gain</span> <span class="o">=</span> <span class="n">decibel</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">leq</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.decimate"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.decimate">[docs]</a>    <span class="k">def</span> <span class="nf">decimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;iir&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Decimate signal by integer `factor`. Before downsampling a low-pass filter is applied.</span>

<span class="sd">        :param factor: Downsampling factor.</span>
<span class="sd">        :param zero_phase: Prevent phase shift by filtering with ``filtfilt`` instead of ``lfilter``.</span>
<span class="sd">        :param ftype: Filter type.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :returns: Decimated signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        .. seealso:: :func:`scipy.signal.decimate`</span>
<span class="sd">        .. seealso:: :meth:`resample`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Signal</span><span class="p">(</span>
            <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">decimate</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">factor</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="n">ftype</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.resample"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.resample">[docs]</a>    <span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resample signal.</span>

<span class="sd">        :param samples: New amount of samples.</span>
<span class="sd">        :param times: Times corresponding to samples.</span>
<span class="sd">        :param axis: Axis.</span>
<span class="sd">        :param window: Window.</span>

<span class="sd">        .. seealso:: :func:`scipy.signal.resample`</span>
<span class="sd">        .. seealso:: :meth:`decimate`</span>

<span class="sd">        You might want to low-pass filter this signal before resampling.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Signal</span><span class="p">(</span><span class="n">resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsamples</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">window</span><span class="p">),</span> <span class="n">nsamples</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.upsample"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.upsample">[docs]</a>    <span class="k">def</span> <span class="nf">upsample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upsample signal with integer factor.</span>

<span class="sd">        :param factor: Upsample factor.</span>
<span class="sd">        :param axis: Axis.</span>

<span class="sd">        .. seealso:: :meth:`resample`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">*</span> <span class="n">factor</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.gain"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.gain">[docs]</a>    <span class="k">def</span> <span class="nf">gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decibel</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply gain of `decibel` decibels.</span>

<span class="sd">        :param decibel: Decibels</span>
<span class="sd">        :param inplace: In place</span>
<span class="sd">        :returns: Amplified signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="n">decibel</span> <span class="o">/</span> <span class="mf">20.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">*=</span> <span class="n">factor</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">factor</span></div>

<div class="viewcode-block" id="Signal.pick"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.pick">[docs]</a>    <span class="k">def</span> <span class="nf">pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get signal from start time to stop time.</span>

<span class="sd">        :param start: Start time.</span>
<span class="sd">        :type start: float</span>
<span class="sd">        :param stop: End time.</span>
<span class="sd">        :type stop: float</span>
<span class="sd">        :returns: Selected part of the signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">start</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">stop</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span></div>

<div class="viewcode-block" id="Signal.times"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.times">[docs]</a>    <span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Time vector.</span>

<span class="sd">        :returns: A vector with a timestamp for each sample.</span>
<span class="sd">        :rtype: :class:`np.ndarray`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span></div>

<div class="viewcode-block" id="Signal.energy"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.energy">[docs]</a>    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Signal energy.</span>

<span class="sd">        :returns: Total energy per channel.</span>
<span class="sd">        :rtype: :class:`np.ndarray`</span>

<span class="sd">        .. math:: E = \\sum_{n=0}^{N-1} |x_n|^2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">((</span><span class="bp">self</span> <span class="o">*</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span></div>

<div class="viewcode-block" id="Signal.power"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.power">[docs]</a>    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Signal power.</span>

<span class="sd">        .. math:: P = \\frac{1}{N} \\sum_{n=0}^{N-1} |x_n|^2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.ms"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.ms">[docs]</a>    <span class="k">def</span> <span class="nf">ms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Mean value squared of signal.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.ms`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.rms"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.rms">[docs]</a>    <span class="k">def</span> <span class="nf">rms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Root mean squared of signal.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.rms`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
        <span class="c1">#return np.sqrt(self.power())</span>

<div class="viewcode-block" id="Signal.weigh"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.weigh">[docs]</a>    <span class="k">def</span> <span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weighting</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply frequency-weighting. By default &#39;A&#39;-weighting is applied.</span>

<span class="sd">        :param weighting: Frequency-weighting filter to apply.</span>
<span class="sd">            Valid options are &#39;A&#39;, &#39;C&#39; and &#39;Z&#39;. Default weighting is &#39;A&#39;.</span>
<span class="sd">        :returns: Weighted signal.</span>
<span class="sd">        :rtype: :class:`Signal`.</span>

<span class="sd">        By default the weighting filter is applied using</span>
<span class="sd">        :func:`scipy.signal.lfilter` causing a frequency-dependent delay. In case a</span>
<span class="sd">        delay is undesired, the filter can applied using :func:`scipy.signal.filtfilt`</span>
<span class="sd">        by settings `zero_phase=True`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num</span><span class="p">,</span> <span class="n">den</span> <span class="o">=</span> <span class="n">WEIGHTING_SYSTEMS</span><span class="p">[</span><span class="n">weighting</span><span class="p">]()</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">bilinear</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">den</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zero_phase</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.correlate"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.correlate">[docs]</a>    <span class="k">def</span> <span class="nf">correlate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Correlate signal with `other` signal. In case `other==None` this</span>
<span class="sd">        method returns the autocorrelation.</span>

<span class="sd">        :param other: Other signal.</span>
<span class="sd">        :param mode: Mode.</span>

<span class="sd">        .. seealso:: :func:`np.correlate`, :func:`scipy.signal.fftconvolve`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">fs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot correlate. Sample frequencies are not the same.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">channels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot correlate. Not supported for multichannel signals.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">fftconvolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.amplitude_envelope"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.amplitude_envelope">[docs]</a>    <span class="k">def</span> <span class="nf">amplitude_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amplitude envelope.</span>

<span class="sd">        :returns: Amplitude envelope of signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.amplitude_envelope`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">amplitude_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.instantaneous_frequency"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.instantaneous_frequency">[docs]</a>    <span class="k">def</span> <span class="nf">instantaneous_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instantaneous frequency.</span>

<span class="sd">        :returns: Instantaneous frequency of signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.instantaneous_frequency`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">instantaneous_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.instantaneous_phase"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.instantaneous_phase">[docs]</a>    <span class="k">def</span> <span class="nf">instantaneous_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instantaneous phase.</span>

<span class="sd">        :returns: Instantaneous phase of signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.instantaneous_phase`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">instantaneous_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.detrend"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.detrend">[docs]</a>    <span class="k">def</span> <span class="nf">detrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Detrend signal.</span>

<span class="sd">        :returns: Detrended version of signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        .. seealso:: :func:`scipy.signal.detrend`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">detrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.unwrap"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.unwrap">[docs]</a>    <span class="k">def</span> <span class="nf">unwrap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unwrap signal in case the signal represents wrapped phase.</span>

<span class="sd">        :returns: Unwrapped signal.</span>
<span class="sd">        :rtype: :class:`Signal`</span>

<span class="sd">        .. seealso:: :func:`np.unwrap`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Signal.complex_cepstrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.complex_cepstrum">[docs]</a>    <span class="k">def</span> <span class="nf">complex_cepstrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complex cepstrum.</span>

<span class="sd">        :param N: Amount of bins.</span>
<span class="sd">        :returns: Quefrency, complex cepstrum and delay in amount of samples.</span>

<span class="sd">        .. seealso:: :func:`acoustics.cepstrum.complex_cepstrum`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">N</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">()</span>
        <span class="n">cepstrum</span><span class="p">,</span> <span class="n">ndelay</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">cepstrum</span><span class="o">.</span><span class="n">complex_cepstrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">cepstrum</span><span class="p">,</span> <span class="n">ndelay</span></div>

<div class="viewcode-block" id="Signal.real_cepstrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.real_cepstrum">[docs]</a>    <span class="k">def</span> <span class="nf">real_cepstrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Real cepstrum.</span>

<span class="sd">        :param N: Amount of bins.</span>
<span class="sd">        :returns: Quefrency and real cepstrum.</span>

<span class="sd">        .. seealso:: :func:`acoustics.cepstrum.real_cepstrum`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">N</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">cepstrum</span><span class="o">.</span><span class="n">real_cepstrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.power_spectrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.power_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Power spectrum.</span>

<span class="sd">        :param N: Amount of bins.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.power_spectrum`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.angle_spectrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.angle_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">angle_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Phase angle spectrum. Wrapped.</span>

<span class="sd">        :param N: amount of bins.</span>

<span class="sd">        .. seealso::</span>

<span class="sd">            :func:`acoustics.signal.angle_spectrum`, :func:`acoustics.signal.phase_spectrum`</span>
<span class="sd">            and :meth:`phase_spectrum`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">angle_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.phase_spectrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.phase_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">phase_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Phase spectrum. Unwrapped.</span>

<span class="sd">        :param N: Amount of bins.</span>

<span class="sd">        .. seealso::</span>

<span class="sd">            :func:`acoustics.signal.phase_spectrum`, :func:`acoustics.signal.angle_spectrum`</span>
<span class="sd">            and :meth:`angle_spectrum`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">phase_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.peak"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.peak">[docs]</a>    <span class="k">def</span> <span class="nf">peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Peak sound pressure.</span>

<span class="sd">        :param axis: Axis.</span>

<span class="sd">        .. seealso::</span>

<span class="sd">            :func:`acoustic.standards.iso_tr_25417_2007.peak_sound_pressure`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iso_tr_25417_2007</span><span class="o">.</span><span class="n">peak_sound_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.peak_level"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.peak_level">[docs]</a>    <span class="k">def</span> <span class="nf">peak_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Peak sound pressure level.</span>

<span class="sd">        :param axis: Axis.</span>

<span class="sd">        .. seealso::</span>

<span class="sd">            :func:`acoustics.standards.iso_tr_25417_2007.peak_sound_pressure_level`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iso_tr_25417_2007</span><span class="o">.</span><span class="n">peak_sound_pressure_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.min"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.min">[docs]</a>    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the minimum along a given axis.</span>

<span class="sd">        Refer to `np.amin` for full documentation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.max"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.max">[docs]</a>    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the minimum along a given axis.</span>

<span class="sd">        Refer to `np.amax` for full documentation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.max_level"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.max_level">[docs]</a>    <span class="k">def</span> <span class="nf">max_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maximum sound pressure level.</span>

<span class="sd">        :param axis: Axis.</span>

<span class="sd">        .. seealso:: :func:`acoustics.standards.iso_tr_25417_2007.max_sound_pressure_level`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iso_tr_25417_2007</span><span class="o">.</span><span class="n">max_sound_pressure_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.sound_exposure"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.sound_exposure">[docs]</a>    <span class="k">def</span> <span class="nf">sound_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sound exposure.</span>

<span class="sd">        :param axis: Axis.</span>

<span class="sd">        .. seealso:: :func:`acoustics.standards.iso_tr_25417_2007.sound_exposure`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iso_tr_25417_2007</span><span class="o">.</span><span class="n">sound_exposure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.sound_exposure_level"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.sound_exposure_level">[docs]</a>    <span class="k">def</span> <span class="nf">sound_exposure_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sound exposure level.</span>

<span class="sd">        :param axis: Axis.</span>

<span class="sd">        .. seealso:: :func:`acoustics.standards.iso_tr_25417_2007.sound_exposure_level`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iso_tr_25417_2007</span><span class="o">.</span><span class="n">sound_exposure_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_complex_cepstrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_complex_cepstrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_complex_cepstrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot complex cepstrum of signal.</span>

<span class="sd">        Valid kwargs:</span>

<span class="sd">        * xscale</span>
<span class="sd">        * yscale</span>
<span class="sd">        * xlim</span>
<span class="sd">        * ylim</span>
<span class="sd">        * frequency: Boolean indicating whether the x-axis should show time in seconds or quefrency</span>
<span class="sd">        * xlabel_frequency: Label in case frequency is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$t$ in s&quot;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$C$&quot;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Complex cepstrum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;xlabel_frequency&#39;</span><span class="p">:</span> <span class="s2">&quot;$f$ in Hz&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">t</span><span class="p">,</span> <span class="n">ceps</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">complex_cepstrum</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">t</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlabel_frequency&#39;</span><span class="p">]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ceps</span> <span class="o">=</span> <span class="n">ceps</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ceps</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_real_cepstrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_real_cepstrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_real_cepstrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot real cepstrum of signal.</span>

<span class="sd">        Valid kwargs:</span>

<span class="sd">        * xscale</span>
<span class="sd">        * yscale</span>
<span class="sd">        * xlim</span>
<span class="sd">        * ylim</span>
<span class="sd">        * frequency: Boolean indicating whether the x-axis should show time in seconds or quefrency</span>
<span class="sd">        * xlabel_frequency: Label in case frequency is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$t$ in s&quot;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$C$&quot;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Real cepstrum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;xlabel_frequency&#39;</span><span class="p">:</span> <span class="s2">&quot;$f$ in Hz&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">t</span><span class="p">,</span> <span class="n">ceps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_cepstrum</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">t</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlabel_frequency&#39;</span><span class="p">]</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ceps</span> <span class="o">=</span> <span class="n">ceps</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ceps</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_power_spectrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_power_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_power_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1">#filename=None, scale=&#39;log&#39;):</span>
        <span class="sd">&quot;&quot;&quot;Plot spectrum of signal.</span>

<span class="sd">        Valid kwargs:</span>

<span class="sd">        * xscale</span>
<span class="sd">        * yscale</span>
<span class="sd">        * xlim</span>
<span class="sd">        * ylim</span>
<span class="sd">        * reference: Reference power</span>

<span class="sd">        .. seealso:: :meth:`power_spectrum`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$f$ in Hz&quot;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$L_</span><span class="si">{p}</span><span class="s2">$ in dB&quot;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="n">REFERENCE_PRESSURE</span><span class="o">**</span><span class="mf">2.0</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">f</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_spectrum</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">o</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]),</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_angle_spectrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_angle_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_angle_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot phase angle spectrum of signal. Wrapped.</span>

<span class="sd">        Valid kwargs:</span>

<span class="sd">        * xscale</span>
<span class="sd">        * yscale</span>
<span class="sd">        * xlim</span>
<span class="sd">        * ylim</span>
<span class="sd">        * reference: Reference power</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$f$ in Hz&quot;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\angle \phi$&quot;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Phase response (wrapped)&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_spectrum</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_phase_spectrum"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_phase_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">plot_phase_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot phase spectrum of signal. Unwrapped.</span>

<span class="sd">        Valid kwargs:</span>

<span class="sd">        * xscale</span>
<span class="sd">        * yscale</span>
<span class="sd">        * xlim</span>
<span class="sd">        * ylim</span>
<span class="sd">        * reference: Reference power</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s2">&quot;$f$ in Hz&quot;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\angle \phi$&quot;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Phase response (unwrapped)&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_spectrum</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.spectrogram"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.spectrogram">[docs]</a>    <span class="k">def</span> <span class="nf">spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Spectrogram of signal.</span>

<span class="sd">        :returns: Spectrogram.</span>

<span class="sd">        See :func:`scipy.signal.spectrogram`. Some of the default values have been changed.</span>
<span class="sd">        The generated spectrogram consists by default of complex values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;nfft&#39;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
            <span class="s1">&#39;noverlap&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
            <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;complex&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">P</span></div>

<div class="viewcode-block" id="Signal.plot_spectrogram"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_spectrogram">[docs]</a>    <span class="k">def</span> <span class="nf">plot_spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot spectrogram of the signal.</span>

<span class="sd">        Valid kwargs:</span>

<span class="sd">        * xlim</span>
<span class="sd">        * ylim</span>
<span class="sd">        * clim</span>
<span class="sd">        .. note:: This method only works for a single channel.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># To do, use :meth:`spectrogram`.</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xlim&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;ylim&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;clim&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;NFFT&#39;</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
            <span class="s1">&#39;noverlap&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Spectrogram&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$t$ in s&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$f$ in Hz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;clabel&#39;</span><span class="p">:</span> <span class="s1">&#39;SPL in dB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;colorbar&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot plot spectrogram of multichannel signal. Please select a single channel.&quot;</span><span class="p">)</span>

        <span class="c1"># Check if an axes object is passed in. Otherwise, create one.</span>
        <span class="n">ax0</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">))</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;noverlap&#39;</span><span class="p">],</span> <span class="n">NFFT</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;NFFT&#39;</span><span class="p">],</span>
                                       <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">,</span> <span class="n">scale_by_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Your version of matplotlib is incompatible due to lack of support of the mode keyword argument to matplotlib.mlab.specgram.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;colorbar&#39;</span><span class="p">]:</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">ax0</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="o">=</span><span class="n">im</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;clabel&#39;</span><span class="p">])</span>

        <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlim&#39;</span><span class="p">])</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ylim&#39;</span><span class="p">])</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;clim&#39;</span><span class="p">])</span>

        <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">])</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">ax0</span></div>

<div class="viewcode-block" id="Signal.levels"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.levels">[docs]</a>    <span class="k">def</span> <span class="nf">levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate sound pressure level as function of time.</span>

<span class="sd">        :param time: Averaging time or integration time constant. Default value is 0.125 corresponding to FAST.</span>
<span class="sd">        :param method: Use time `average` or time `weighting`. Default option is `average`.</span>
<span class="sd">        :returns: sound pressure level as function of time.</span>

<span class="sd">        .. seealso:: :func:`acoustics.standards.iec_61672_1_2013.time_averaged_sound_level`</span>
<span class="sd">        .. seealso:: :func:`acoustics.standards.iec_61672_1_2013.time_weighted_sound_level`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iec_61672_1_2013</span><span class="o">.</span><span class="n">time_averaged_sound_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;weighting&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iec_61672_1_2013</span><span class="o">.</span><span class="n">time_weighted_sound_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid method&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.leq"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.leq">[docs]</a>    <span class="k">def</span> <span class="nf">leq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Equivalent level. Single-value number.</span>

<span class="sd">        .. seealso:: :func:`acoustics.standards.iso_tr_25417_2007.equivalent_sound_pressure_level`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">standards</span><span class="o">.</span><span class="n">iso_tr_25417_2007</span><span class="o">.</span><span class="n">equivalent_sound_pressure_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_levels"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_levels">[docs]</a>    <span class="k">def</span> <span class="nf">plot_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot sound pressure level as function of time.</span>

<span class="sd">        .. seealso:: :meth:`levels`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$t$ in s&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$L_{p,F}$ in dB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="mf">0.125</span><span class="p">,</span>
            <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span>
            <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">])</span>
        <span class="n">L_masked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">L</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">L_masked</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

    <span class="c1">#def octave(self, frequency, fraction=1):</span>
    <span class="c1">#&quot;&quot;&quot;Determine fractional-octave `fraction` at `frequency`.</span>

    <span class="c1">#.. seealso:: :func:`acoustics.signal.fractional_octaves`</span>

    <span class="c1">#&quot;&quot;&quot;</span>
    <span class="c1">#return acoustics.signal.fractional_octaves(self, self.fs, frequency,</span>
    <span class="c1">#frequency, fraction, False)[1]</span>

<div class="viewcode-block" id="Signal.bandpass"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.bandpass">[docs]</a>    <span class="k">def</span> <span class="nf">bandpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter signal with band-pass filter.</span>

<span class="sd">        :param lowcut: Lower cornerfrequency.</span>
<span class="sd">        :param highcut: Upper cornerfrequency.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>

<span class="sd">        :returns: Band-pass filtered signal.</span>
<span class="sd">        :rtype: :class:`Signal`.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.bandpass`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">bandpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.bandstop"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.bandstop">[docs]</a>    <span class="k">def</span> <span class="nf">bandstop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter signal with band-stop filter.</span>

<span class="sd">        :param lowcut: Lower cornerfrequency.</span>
<span class="sd">        :param highcut: Upper cornerfrequency.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>

<span class="sd">        :returns: Band-pass filtered signal.</span>
<span class="sd">        :rtype: :class:`Signal`.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.bandstop`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">bandstop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.highpass"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.highpass">[docs]</a>    <span class="k">def</span> <span class="nf">highpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter signal with high-pass filter.</span>

<span class="sd">        :param cutoff: Cornerfrequency.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: High-pass filtered signal.</span>
<span class="sd">        :rtype: :class:`Signal`.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.highpass`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">highpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.lowpass"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.lowpass">[docs]</a>    <span class="k">def</span> <span class="nf">lowpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter signal with low-pass filter.</span>

<span class="sd">        :param cutoff: Cornerfrequency.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: Low-pass filtered signal.</span>
<span class="sd">        :rtype: :class:`Signal`.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.lowpass`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lowpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.octavepass"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.octavepass">[docs]</a>    <span class="k">def</span> <span class="nf">octavepass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">fraction</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter signal with fractional-octave band-pass filter.</span>

<span class="sd">        :param center: Center frequency. Any value in the band will suffice.</span>
<span class="sd">        :param fraction: Band designator.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: Band-pass filtered signal.</span>
<span class="sd">        :rtype: :class:`Signal`.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.octavepass`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">octavepass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="n">fraction</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                                                      <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.bandpass_frequencies"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.bandpass_frequencies">[docs]</a>    <span class="k">def</span> <span class="nf">bandpass_frequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply bandpass filters for frequencies.</span>

<span class="sd">        :param frequencies: Band-pass filter frequencies.</span>
<span class="sd">        :type frequencies: Instance of :class:`acoustics.signal.Frequencies`</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param purge: Discard bands of which the upper corner frequency is above the Nyquist frequency.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: Frequencies and band-pass filtered signal.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.bandpass_frequencies`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequencies</span><span class="p">,</span> <span class="n">filtered</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">bandpass_frequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">purge</span><span class="p">,</span>
                                                                      <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frequencies</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">filtered</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.octaves"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.octaves">[docs]</a>    <span class="k">def</span> <span class="nf">octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="n">NOMINAL_OCTAVE_CENTER_FREQUENCIES</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply 1/1-octaves bandpass filters.</span>

<span class="sd">        :param frequencies: Band-pass filter frequencies.</span>
<span class="sd">        :type frequencies: :class:`np.ndarray` with (approximate) center-frequencies or an instance of :class:`acoustics.signal.Frequencies`</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param purge: Discard bands of which the upper corner frequency is above the Nyquist frequency.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: Frequencies and band-pass filtered signal.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.bandpass_octaves`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequencies</span><span class="p">,</span> <span class="n">octaves</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">bandpass_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">purge</span><span class="p">,</span>
                                                                 <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frequencies</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">octaves</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.third_octaves"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.third_octaves">[docs]</a>    <span class="k">def</span> <span class="nf">third_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="n">NOMINAL_THIRD_OCTAVE_CENTER_FREQUENCIES</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply 1/3-octaves bandpass filters.</span>

<span class="sd">        :param frequencies: Band-pass filter frequencies.</span>
<span class="sd">        :type frequencies: :class:`np.ndarray` with (approximate) center-frequencies or an instance of :class:`acoustics.signal.Frequencies`</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param purge: Discard bands of which the upper corner frequency is above the Nyquist frequency.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: Frequencies and band-pass filtered signal.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.bandpass_third_octaves`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequencies</span><span class="p">,</span> <span class="n">octaves</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">bandpass_third_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">purge</span><span class="p">,</span>
                                                                       <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frequencies</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">octaves</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.fractional_octaves"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.fractional_octaves">[docs]</a>    <span class="k">def</span> <span class="nf">fractional_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply 1/N-octaves bandpass filters.</span>

<span class="sd">        :param frequencies: Band-pass filter frequencies.</span>
<span class="sd">        :type frequencies: Instance of :class:`acoustics.signal.Frequencies`</span>
<span class="sd">        :param fraction: Default band-designator of fractional-octaves.</span>
<span class="sd">        :param order: Filter order.</span>
<span class="sd">        :param purge: Discard bands of which the upper corner frequency is above the Nyquist frequency.</span>
<span class="sd">        :param zero_phase: Prevent phase error by filtering in both directions (filtfilt).</span>
<span class="sd">        :returns: Frequencies and band-pass filtered signal.</span>

<span class="sd">        .. seealso:: :func:`acoustics.signal.bandpass_fractional_octaves`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">frequencies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frequencies</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">OctaveBand</span><span class="p">(</span><span class="n">fstart</span><span class="o">=</span><span class="n">NOMINAL_THIRD_OCTAVE_CENTER_FREQUENCIES</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                      <span class="n">fstop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="n">fraction</span><span class="p">)</span>
        <span class="n">frequencies</span><span class="p">,</span> <span class="n">octaves</span> <span class="o">=</span> <span class="n">acoustics</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">bandpass_fractional_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">fraction</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span>
                                                                            <span class="n">purge</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frequencies</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">octaves</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_octaves"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_octaves">[docs]</a>    <span class="k">def</span> <span class="nf">plot_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot octaves.</span>

<span class="sd">        .. seealso:: :meth:`octaves`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$f$ in Hz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$L_</span><span class="si">{p}</span><span class="s1">$ in dB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;1/1-Octaves SPL&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">octaves</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">center</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">leq</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">leq</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_third_octaves"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_third_octaves">[docs]</a>    <span class="k">def</span> <span class="nf">plot_third_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot 1/3-octaves.</span>

<span class="sd">        .. seealso:: :meth:`third_octaves`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$f$ in Hz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$L_</span><span class="si">{p}</span><span class="s1">$ in dB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;1/3-Octaves SPL&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">third_octaves</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">leq</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot_fractional_octaves"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot_fractional_octaves">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fractional_octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot fractional octaves.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;1/</span><span class="si">{}</span><span class="s1">-Octaves SPL&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$f$ in Hz&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$L_p$ in dB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fractional_octaves</span><span class="p">(</span><span class="n">frequencies</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="n">fraction</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">purge</span><span class="o">=</span><span class="n">purge</span><span class="p">,</span>
                                       <span class="n">zero_phase</span><span class="o">=</span><span class="n">zero_phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">leq</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="Signal.plot"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot signal as function of time. By default the entire signal is plotted.</span>

<span class="sd">        :param filename: Name of file.</span>
<span class="sd">        :param start: First sample index.</span>
<span class="sd">        :type start: Start time in seconds from start of signal.</span>
<span class="sd">        :param stop: Last sample index.</span>
<span class="sd">        :type stop: Stop time in seconds. from stop of signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$t$ in s&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;$x$ in -&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Signal&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_base_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">(),</span> <span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

    <span class="c1">#def plot_scalo(self, filename=None):</span>
    <span class="c1">#&quot;&quot;&quot;</span>
    <span class="c1">#Plot scalogram</span>
    <span class="c1">#&quot;&quot;&quot;</span>
    <span class="c1">#from scipy.signal import ricker, cwt</span>

    <span class="c1">#wavelet = ricker</span>
    <span class="c1">#widths = np.logspace(-1, 3.5, 10)</span>
    <span class="c1">#x = cwt(self, wavelet, widths)</span>

    <span class="c1">#interpolation = &#39;nearest&#39;</span>

    <span class="c1">#from matplotlib.ticker import LinearLocator, AutoLocator, MaxNLocator</span>
    <span class="c1">#majorLocator = LinearLocator()</span>
    <span class="c1">#majorLocator = MaxNLocator()</span>

    <span class="c1">#fig = plt.figure()</span>
    <span class="c1">#ax = fig.add_subplot(111)</span>
    <span class="c1">#ax.set_title(&#39;Scaleogram&#39;)</span>
    <span class="c1">##ax.set_xticks(np.arange(0, x.shape[1])*self.fs)</span>
    <span class="c1">##ax.xaxis.set_major_locator(majorLocator)</span>

    <span class="c1">##ax.imshow(10.0 * np.log10(x**2.0), interpolation=interpolation, aspect=&#39;auto&#39;, origin=&#39;lower&#39;)#, extent=[0, 1, 0, len(x)])</span>
    <span class="c1">#ax.pcolormesh(np.arange(0.0, x.shape[1])/self.fs, widths, 10.0*np.log(x**2.0))</span>
    <span class="c1">#if filename:</span>
    <span class="c1">#fig.savefig(filename)</span>
    <span class="c1">#else:</span>
    <span class="c1">#return fig</span>

    <span class="c1">#def plot_scaleogram(self, filename):</span>
    <span class="c1">#&quot;&quot;&quot;</span>
    <span class="c1">#Plot scaleogram</span>
    <span class="c1">#&quot;&quot;&quot;</span>
    <span class="c1">#import pywt</span>

    <span class="c1">#wavelet = &#39;dmey&#39;</span>
    <span class="c1">#level = pywt.dwt_max_level(len(self), pywt.Wavelet(wavelet))</span>
    <span class="c1">#print level</span>
    <span class="c1">#level = 20</span>
    <span class="c1">#order = &#39;freq&#39;</span>
    <span class="c1">#interpolation = &#39;nearest&#39;</span>

    <span class="c1">#wp = pywt.WaveletPacket(self, wavelet, &#39;sym&#39;, maxlevel=level)</span>
    <span class="c1">#nodes = wp.get_level(level, order=order)</span>
    <span class="c1">#labels = [n.path for n in nodes]</span>
    <span class="c1">#values = np.abs(np.array([n.data for n in nodes], &#39;d&#39;))</span>

    <span class="c1">#fig = plt.figure()</span>
    <span class="c1">#ax = fig.add_subplot(111)</span>
    <span class="c1">#ax.set_title(&#39;Scaleogram&#39;)</span>
    <span class="c1">#ax.imshow(values, interpolation=interpolation, aspect=&#39;auto&#39;, origin=&#39;lower&#39;, extent=[0, 1, 0, len(values)])</span>
    <span class="c1">##ax.set_yticks(np.arange(0.5, len(labels) + 0.5))</span>
    <span class="c1">##ax.set_yticklabels(labels)</span>

    <span class="c1">#fig.savefig(filename)</span>

<div class="viewcode-block" id="Signal.normalize"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Normalize signal.</span>

<span class="sd">        :param gap: Gap between maximum value and ceiling in decibel.</span>
<span class="sd">        :param inplace: Normalize signal in place.</span>

<span class="sd">        The parameter `gap` can be understood as using `gap` decibels fewer for the dynamic range.</span>
<span class="sd">        By default a 6 decibel gap is used.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="n">gap</span> <span class="o">/</span> <span class="mf">20.0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">/=</span> <span class="n">factor</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="o">/</span> <span class="n">factor</span></div>

<div class="viewcode-block" id="Signal.to_wav"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.to_wav">[docs]</a>    <span class="k">def</span> <span class="nf">to_wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save signal as WAV file.</span>

<span class="sd">        :param filename: Name of file to save to.</span>
<span class="sd">        :param depth: If given, convert to integer with specified depth. Else, try to store using the original data type.</span>

<span class="sd">        By default, this function saves a normalized 16-bit version of the signal with at least 6 dB range till clipping occurs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">depth</span> <span class="k">else</span> <span class="s1">&#39;int&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">depth</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">wavfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fs</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></div>
        <span class="c1">#wavfile.write(filename, int(self.fs), self._data/np.abs(self._data).max() *  0.5)</span>
        <span class="c1">#wavfile.write(filename, int(self.fs), np.int16(self._data/(np.abs(self._data).max()) * 32767) )</span>

<div class="viewcode-block" id="Signal.from_wav"><a class="viewcode-back" href="../../reference.html#acoustics.Signal.from_wav">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_wav</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instance of `Signal` from a WAV file.</span>

<span class="sd">        :param filename: Filename</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fs</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">data</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span></div></div>


<span class="n">_PLOTTING_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;xscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
    <span class="s1">&#39;yscale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xlim&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="s1">&#39;ylim&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;linestyles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_get_plotting_params</span><span class="p">():</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">_PLOTTING_PARAMS</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>


<span class="k">def</span> <span class="nf">_base_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">given_params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Common function for creating plots.</span>

<span class="sd">    :returns: Axes object.</span>
<span class="sd">    :rtype: :class:`matplotlib.Axes`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">_get_plotting_params</span><span class="p">()</span>
    <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">given_params</span><span class="p">)</span>

    <span class="n">linestyles</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;linestyles&#39;</span><span class="p">]))</span>

    <span class="c1"># Check if an axes object is passed in. Otherwise, create one.</span>
    <span class="n">ax0</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">))</span>

    <span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
            <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">linestyles</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;xscale&#39;</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;yscale&#39;</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;xlim&#39;</span><span class="p">])</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ylim&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ax0</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Signal&quot;</span><span class="p">]</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">acoustics 0.2.0.post1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 1970, Frederik Rietdijk.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>